"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[204],{60204:(e,t,a)=>{a.d(t,{default:()=>M});var s=a(95155),l=a(12115),i=a(90221),n=a(62177),o=a(55594),r=a(30285),d=a(17759),c=a(62523),u=a(80333),m=a(59409),p=a(17649),f=a(59434);let x=p.bL;p.l9;let h=p.ZL,b=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(p.hJ,{className:(0,f.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...l,ref:t})});b.displayName=p.hJ.displayName;let j=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsxs)(h,{children:[(0,s.jsx)(b,{}),(0,s.jsx)(p.UC,{ref:t,className:(0,f.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...l})]})});j.displayName=p.UC.displayName;let y=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,f.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})};y.displayName="AlertDialogHeader";let g=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,f.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};g.displayName="AlertDialogFooter";let v=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(p.hE,{ref:t,className:(0,f.cn)("text-lg font-semibold",a),...l})});v.displayName=p.hE.displayName;let N=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(p.VY,{ref:t,className:(0,f.cn)("text-sm text-muted-foreground",a),...l})});N.displayName=p.VY.displayName;let w=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(p.rc,{ref:t,className:(0,f.cn)((0,r.r)(),a),...l})});w.displayName=p.rc.displayName;let F=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)(p.ZD,{ref:t,className:(0,f.cn)((0,r.r)({variant:"outline"}),"mt-2 sm:mt-0",a),...l})});F.displayName=p.ZD.displayName;var C=a(88539),S=a(40283),k=a(25731),R=a(91950),z=a(87481),A=a(73672),T=a(66695),J=a(22346);let V=e=>o.Ik({analysisType:o.au.number({required_error:"Please select an analysis type."}),topology:o.bz().optional(),configuration:o.bz().optional(),otherFile1:o.bz().optional(),otherFile2:o.bz().optional(),bool1:o.zM().optional(),int1:o.au.number().optional(),str1:o.Yj().optional(),str2:o.Yj().optional(),double1:o.au.number().optional(),inlist:o.Yj().optional(),cpus:o.au.number().int().positive().optional()}).superRefine((t,a)=>{if(void 0===t.analysisType)return;let s=R.W9.find(e=>e.value===t.analysisType);if(s)for(let l of s.files)!l.required||!e&&("topology"===l.name||"configuration"===l.name)||t[l.name]instanceof File||a.addIssue({code:o.eq.custom,path:[l.name],message:"".concat(l.label," is required.")})});function M(e){let{jobId:t}=e,{user:a}=(0,S.A)(),{toast:o}=(0,z.dj)(),p=!t,[f,h]=(0,l.useState)(!1),[b,M]=(0,l.useState)(!1),I=(0,l.useMemo)(()=>V(p),[p]),q=(0,n.mN)({resolver:(0,i.u)(I),defaultValues:{cpus:1,bool1:!1}}),D=q.watch("analysisType"),Y=(0,l.useMemo)(()=>R.W9.find(e=>e.value===D),[D]),E=(e,t)=>{var a;let s=null==(a=e.target.files)?void 0:a[0];q.setValue(t,s||null,{shouldValidate:!0})},Z=async e=>{if(!a||!Y)return;let s={userID:a.id,analysisType:e.analysisType,cpus:e.cpus||1,bool1:e.bool1,int1:e.int1,str1:e.str1,str2:e.str2,double1:e.double1,inlist:e.inlist,topology:e.topology instanceof File?e.topology:void 0,configuration:e.configuration instanceof File?e.configuration:void 0,otherFile1:e.otherFile1 instanceof File?e.otherFile1:void 0,otherFile2:e.otherFile2 instanceof File?e.otherFile2:void 0};p||(s.jobUuid=t,s.jobLocation=t);try{let e=await k.F.startAnalysisJob(s);o({title:"Analysis Job Submitted",description:"".concat(Y.label," analysis started with ID: ").concat(e,".")}),q.reset({...q.getValues(),str1:"",str2:"",int1:void 0,double1:void 0,bool1:!1})}catch(e){console.error("Failed to submit analysis job:",e),o({title:"Submission Failed",description:e.message||"An unknown error occurred.",variant:"destructive"})}},_=async e=>{if(p||!t||!(null==Y?void 0:Y.outputFile))return void await Z(e);M(!0);try{(await k.F.listJobFiles(t)).includes(Y.outputFile)?h(!0):await Z(e)}catch(t){o({title:"Could not check for existing files.",description:"Proceeding with submission...",variant:"default"}),await Z(e)}finally{M(!1)}};return(0,s.jsxs)(d.lV,{...q,children:[(0,s.jsx)(x,{open:f,onOpenChange:h,children:(0,s.jsxs)(j,{children:[(0,s.jsxs)(y,{children:[(0,s.jsx)(v,{children:"File Already Exists"}),(0,s.jsxs)(N,{children:["The output file ",(0,s.jsx)("code",{className:"bg-muted px-1 py-0.5 rounded font-semibold",children:null==Y?void 0:Y.outputFile})," already exists for this job. Running this analysis again may overwrite it. Are you sure you want to continue?"]})]}),(0,s.jsxs)(g,{children:[(0,s.jsx)(F,{children:"Cancel"}),(0,s.jsx)(w,{onClick:()=>Z(q.getValues()),children:"Yes, Submit Anyway"})]})]})}),(0,s.jsxs)("form",{onSubmit:q.handleSubmit(_),className:"space-y-6",children:[(0,s.jsx)(d.zB,{control:q.control,name:"analysisType",render:e=>{var t;let{field:a}=e;return(0,s.jsxs)(d.eI,{children:[(0,s.jsx)(d.lR,{children:"Analysis Type"}),(0,s.jsxs)(m.l6,{onValueChange:e=>a.onChange(Number(e)),defaultValue:null==(t=a.value)?void 0:t.toString(),children:[(0,s.jsx)(d.MJ,{children:(0,s.jsx)(m.bq,{children:(0,s.jsx)(m.yv,{placeholder:"Select an analysis protocol..."})})}),(0,s.jsx)(m.gC,{children:R.W9.map(e=>(0,s.jsxs)(m.eb,{value:String(e.value),children:[e.label," (",e.command,")"]},e.value))})]}),Y&&(0,s.jsx)(d.Rr,{children:Y.description}),(0,s.jsx)(d.C5,{})]})}}),Y&&(0,s.jsxs)(T.Zp,{className:"border-dashed",children:[(0,s.jsx)(T.aR,{children:(0,s.jsxs)(T.ZB,{children:["Parameters for: ",Y.label]})}),(0,s.jsxs)(T.Wu,{className:"space-y-4",children:[Y.files.map(e=>{let t=!p&&("topology"===e.name||"configuration"===e.name);return(0,s.jsx)(d.zB,{control:q.control,name:e.name,render:a=>{let{field:l}=a;return(0,s.jsxs)(d.eI,{children:[(0,s.jsxs)(d.lR,{children:[e.label," ",e.required&&!t&&(0,s.jsx)("span",{className:"text-destructive",children:"*"})]}),t?(0,s.jsx)("div",{className:"text-sm p-3 bg-muted rounded-md border text-muted-foreground",children:"âœ“ Using file from the original simulation job."}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.MJ,{children:(0,s.jsx)(c.p,{type:"file",onChange:t=>E(t,e.name)})}),(0,s.jsx)(d.Rr,{children:e.description}),(0,s.jsx)(d.C5,{})]})]})}},e.name)}),Y.params.map(e=>(0,s.jsx)(d.zB,{control:q.control,name:e.backendName,render:t=>{var a,l;let{field:i}=t;return(0,s.jsxs)(d.eI,{children:[(0,s.jsx)(d.lR,{children:e.label}),"boolean"===e.type?(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(d.MJ,{children:(0,s.jsx)(u.d,{checked:i.value,onCheckedChange:i.onChange})}),e.description&&(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:e.description})]}):"textarea"===e.type?(0,s.jsx)(d.MJ,{children:(0,s.jsx)(C.T,{placeholder:e.description,...i,value:null!=(a=i.value)?a:""})}):(0,s.jsx)(d.MJ,{children:(0,s.jsx)(c.p,{type:e.type,placeholder:e.description,...i,value:null!=(l=i.value)?l:""})}),(0,s.jsx)(d.C5,{})]})}},e.name))]})]}),(0,s.jsx)(J.Separator,{}),(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsxs)(r.$,{type:"submit",size:"lg",disabled:!Y||q.formState.isSubmitting||b,children:[(0,s.jsx)(A.A,{className:"mr-2 h-5 w-5"}),q.formState.isSubmitting||b?"Submitting...":"Submit Analysis"]})})]})]})}},88539:(e,t,a)=>{a.d(t,{T:()=>n});var s=a(95155),l=a(12115),i=a(59434);let n=l.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,s.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...l})});n.displayName="Textarea"}}]);